<html>
    <head>
        <script src="//codebase.meta4vr.net/carnival/thirdparty/wglu-program.js"></script>
        <script src="//codebase.meta4vr.net/carnival/thirdparty/gl-matrix-min.js"></script>
        
        <script src="//codebase.meta4vr.net/carnival/lib/fc_util.js"></script>
        <script src="//codebase.meta4vr.net/carnival/lib/fc_primitives.js"></script>
        <script src="//codebase.meta4vr.net/carnival/lib/fc_basicshapes.js"></script>
        <script src="//codebase.meta4vr.net/carnival/lib/fc_scene.js"></script>
        <script src="//codebase.meta4vr.net/carnival/lib/fc_feedtools.js"></script>
        <script src="scene.js"></script>
        
        <script src="webgl-obj-loader/webgl-obj-loader.js"></script>
        <script>console.log(OBJ); </script>
        
    </head>
    <body>
        <div id="error-container" style="display: none;">
            <p>Seems like something went wrong.</p>
            <p id="error-detail">...</p>
        </div>
        <div id="canvas-container">
            <canvas id="webgl-canvas" style="height: 30%;"></canvas>
        </div>
        <div id="controls-container">
            <div id="readouts-container">
                <input type="text" id="readoutA"><br>
                <input type="text" id="readoutB"><br>
                <input type="text" id="readoutC"><br>
                <input type="text" id="readoutD"><br>
                <input type="text" id="readoutE"><br>
            </div>
        </div>
        
        
        <div>
            <p>
                Both controllers behave the same, and there are 3 modes. Switch modes with the menu button (above the trackpad).
            </p>
            <p>Mode 1: Select and place a model. A low-poly preview of a model will appear above your controller. Click
                trackpad to change models, point controller at the ground and press trigger to place.</p>
            <p>Mode 2: Move, scale and rotate. Trackpad left/right rotates, trackpad up/down makes bigger and smaller, 
                point controller at ground and pull trigger to move current model.
            </p>
            <p>Mode 3: Doesn't do anything just yet but will probably be used for choosing colours.</p>
            
            <p>In all modes, point controller at ground and press grip button to teleport.</p>
            
            <p>Known issues:</p>
            <ul>
                <li>Mesh parse causes a glitch (pretty severe for larger meshes)</li>
                <li>It's not obvious that anything has happened when you first place a model, ie. no loading indicator</li>
                <li>Currently no way of selecting a model, you can only operate on the most-recently-placed one.</li>
                <li>Attachment of floating preview models to controller is pretty inconsistent.</li>
                <li>No texture coords</li>
                <li>Things are just like, way too green.</li>
            </ul>
            
            <p>Thanks to:</p>
            <ul>
                <li>X for the obj loader code</li>
                <li>Y for the use of the Lowpoly Vive Controller model</li>
                <li>Z for the STL and OBJ models (weblink)</li>
            </ul>
            
            <p>If you've got 3d models you'd like to contribute to this, drop me a line!</p>
            
        </div>
        
        <script>
        window.vrScene = new ExperimentalScene();
        
        window.showError = function (errorMessage) {
            document.getElementById('error-container').style.display = 'block';
            var detailP = document.getElementById('error-detail');
            if (errorMessage) {
                detailP.innerHTML = '\<strong>Error detail:\</strong> ' + errorMessage;
            }
            else {
                detailP.innerText = '';
            }
            
        };
        

        window.updateReadout = function (readoutIdent, newValue) {
            var readoutElem = document.getElementById('readout' + readoutIdent);
            readoutElem.value = newValue;
        }

        
        </script>
        <script src="//codebase.meta4vr.net/carnival/lib/fc_engine.js"></script>
        <script>
        var S = vrScene;
        var dump = function(obj) {
            console.log('{scale: '+obj.scaleFactor+', ry: '+obj.orientation.y+', x: '+obj.pos.x+', y: '+obj.pos.y+', z: '+obj.pos.z+'}');
        }
        </script>
    </body>
</html>
